<import src="../itemTabBarTemp/itemTabBarTemp.wxml"></import>
<import src="../template/template.wxml"></import>

<CustomNavBar isBack ="{{true}}"></CustomNavBar>
<!-- The background page should be blurred if backgroundBlur == true-->
<view id="body" class="{{backgroundBlur ? 'blurredElement' : ''}}">
  <!-- Add the sliding image component-->
  <view id="swiperContainer">
    <swiper indicator-dots="{{indicatorDots}}" autoplay="{{autoplay}}" duration="{{duration}}" circular="{{circular}}" style="height: 100%; width: 100%">
      <block wx:for="{{itemImages}}" wx:key="*this" wx:for-item="imgSrc">
        <swiper-item>
          <image src="{{imgSrc}}" mode="aspectFill" style="width: 100%; height: 100%;"></image>    
        </swiper-item>
      </block>
    </swiper>
  </view>
  <!-- Takes in the item type: "product" or "event" and displays accordingly-->
  <view id="customDescContainer">
    <block wx:if="{{itemType === 'product'}}">
      <view class="descContainer">
        <!-- Contains the price, title, and buttons-->
        <view class="priceCard paddingElement">
          <!-- Contains two block elements and padding-->
          <view id="titleRow">
            <text>{{title ? title : 'Loading...'}}</text>
            <!--Contains the favorite and forward icon-->
            <view id="iconsContainer" style="display:flex">
              <view hover-class="mp-icon-hover" bindtap="clickHeart" hover-stay-time="{{200}}">
                <mp-icon icon="like" size="{{30}}" color="black" type="{{isFavorited ? 'field' : 'outline'}}"></mp-icon>
              </view>
              <view hover-class="mp-icon-hover" hover-stay-time="{{200}}">
                <mp-icon icon="share" size="{{30}}" color="black"></mp-icon>
              </view>
              
            </view>
          </view>
          <view id="mainRow">
            <!--Contains description and category tags-->
            <view class="viewPadding" id="leftBox">
              <view id="desc">
                <text>{{descSummary}}</text>
              </view>
              <!--Contains buttons that label the categories (like flairs)-->
              <view id="categoryButtons">
                <view wx:for="{{itemCategories}}" wx:for-index="idx" wx:for-item="category">
                  <button class="mini-btn" type="primary" >{{category}}</button>
                </view>
              </view>
            </view>
            <!--Contains price-->
            <view id="rightBox">
              <text>{{priceStr}}</text>
            </view>
          </view>   
        </view>
        <!-- Contains the item description-->
        <view class="descBox paddingElement viewPadding">
          <text>Some stuff goes here.</text>
        </view>  
      </view>
    </block>
    <block wx:elif="{{itemType === 'event'}}">
      <text>Event</text>
    </block>
    <block wx:else>
      <text>Error- only product or event are valid parameters for itemDesc component.</text>
    </block>

  </view>
  
</view>
<!--This is the popup card on the bottom half of the screen that allows the user to choose a quantity
    Visible only when addToCart() is activated and displayPopUp is true-->
<view id="cartPopUpContainer" class="spacedVerticalContainer sidePadding" wx:if="{{displayPopUp}}">
  <!--Contains the X out button on the right of this container-->
  <view id="closeContainer">
    <!--X button will trigger clickClose() on tap-->
    <view hover-class="mp-icon-hover" bindtap="clickClose" hover-stay-time="{{200}}">
      <mp-icon icon="close" size="{{25}}"></mp-icon>
    </view>
  </view>
  <!--Contains the image on left and title and price on right-->
  <view id="cardContainer" class="spacedVerticalElement">
    <view id="imageContainer">
      <image mode="aspectFill" src="{{coverImageSrc}}" style="height: 100%; width: 100%;"></image>
    </view>
    <view id="descContainer" class="viewPadding">
      <text>{{title ? title : 'Loading...'}}</text>
      <text>{{priceStr}}</text>
    </view>
  </view>
  <!--Contains picker to adjust quantity-->
  <view id="quantityContainer" class="spacedVerticalElement">
    <text>Quantity</text>
    <vant-stepper value="{{1}}" input-width="60px" button-size="45px" min="1" max="99" bind:change="quantityChange"></vant-stepper>
  </view>
  <!--Contains add to cart and buy buttons-->
  <view id="buttonsContainer" class="spacedVerticalElement">
    <!--DEV: Figure out how to customize the button (weUI? button css?)-->
    <button id="addToCartButton" class="cartButton" bindtap="addToCart">Add to Cart</button>
    <button id="buyButton" class="cartButton">Buy Now</button>
  </view>  
</view>

<!-- When the add to cart button is tapped, the tabBar will trigger the addToCart function in this js file
      addToCart function will set isTabBarHidden=true, which will then pass to component and cause tabBar to not render in wxif-->
<CustomTabBar numItems="{{numCartItems}}" isTabBarHidden="{{isTabBarHidden}}" tabbarHeight="{{tabbarHeight}}" itemType="{{itemType}}" bindaddToCart="tabBarAddToCart"></CustomTabBar>




